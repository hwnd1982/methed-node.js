const generateUID = length => {
  const digit = new Array(length).fill('0').join('');

  return `${digit}${Math.floor(Math.random() * + `0x1${digit}`).toString(36)}`.slice(-5) +
  `${Date.now().toString(36).slice(-5)}`;
};

const capitalizeFirstLetter = str => {
  str = str.trim().toLowerCase();

  return `${str[0].toUpperCase()}${str.slice(1)}`;
};

exports.getExtendedData =  ({name, dateOfBirth, purpose}) => {
  const [firstname, lastname] = name.split(/\s+/).map(capitalizeFirstLetter);

  return {
    id: generateUID(10),
    firstname,
    lastname,
    dateOfBirth,
    age: Math.floor((new Date().getTime() - new Date(dateOfBirth.split(/\s|\.|\-/).reverse().join('-')).getTime()) / 31536000000),
    purpose: capitalizeFirstLetter(purpose),
  };
};
