const uid = length => {
  const digit = new Array(length).fill('0').join('');

  return `${digit}${Math.floor(Math.random() * + `0x1${digit}`).toString(36)}`.slice(-5) +
  `${Date.now().toString(36).slice(-5)}`;
};

const format = str => {
  str = str.trim().toLowerCase();

  return `${str[0].toUpperCase()}${str.slice(1)}`;
};

exports.getExtendedData =  ({name, dateBirth, purpose}) => {
  const [firstname, lastname] = name.split(/\s+/).map(item => format(item));

  return {
    id: uid(10),
    firstname,
    lastname,
    dateBirth,
    age: Math.floor((new Date().getTime() - new Date(dateBirth.split(/\s|\.|\-/).reverse().join('-')).getTime()) / 31536000000),
    purpose: format(purpose),
  };
}